# Ante un push, descarga el codigo, hace build y reinicia el proyecto.

name: Build.js CI


on:
  push:
    branches: [ "master" ]
  workflow_dispatch:

jobs:
  build:
    runs-on: self-hosted
    steps:
      - run: echo "🎉 The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo "🐧 This job is now running on a ${{ runner.os }} on an self hosted server !"
      - run: echo "🔎 The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - uses: actions/checkout@v4
      - name: Use Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20.x'
      - name: Instalar Paquetes,
        run: npm ci
      - name: Instalar PM2.
        run: npm install -g pm2
      - name: Build de la App.
        run: npm run build --if-present
      - name: Re Iniciar PM2.
        run: npm run pm2-restart
      - run: echo "🍏 This job's status is ${{ job.status }}. Ok "
      - name: Enviar Whatsapp de Confirmacion.
        run: npm run okBuild

